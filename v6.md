Bản mô tả Hoàn thiện: Hệ thống Quản lý Nhiệm vụ (Phiên bản Final 6.0)

Giới thiệu: Tài liệu này mô tả toàn diện các vai trò, quy tắc nghiệp vụ, luồng xử lý, yêu cầu giao diện và hệ thống thông báo. Đây là nguồn thông tin chính (single source of truth) để đội ngũ thiết kế, phát triển và kiểm thử hệ thống.



1\. Các Vai trò trong Hệ thống (User Roles)

Lãnh đạo Cơ quan (Super Admin): Vai trò quản trị cao nhất. Có quyền xem và giao việc cho toàn bộ nhân sự. Không thể bị người khác giao việc.



Lãnh đạo Văn phòng: Quản lý và duyệt nhiệm vụ cho Chuyên viên Văn phòng. Có quyền giao việc cho Lãnh đạo Phòng và Chuyên viên Văn phòng.



Lãnh đạo Phòng: Quản lý, giao việc và đánh giá công việc cho Chuyên viên trong phòng ban của mình.



Chuyên viên Văn phòng: Nhân viên thuộc khối văn phòng.



Chuyên viên Phòng: Nhân viên thuộc các phòng ban chuyên môn.



2\. Đối tượng chính: Nhiệm vụ (Task Object)

Thuộc tính (Attributes): task\_id, title, description, creator\_id, assigner\_id, assignee\_id, department\_id, status, score, audit\_log.



Các Trạng thái (Statuses): PENDING\_ASSIGNMENT\_APPROVAL, ASSIGNED, PENDING\_COMPLETION\_APPROVAL, COMPLETED.



3\. Quy tắc và Phân quyền (Rules \& Permissions)

3.1. Quy tắc chung về Hành động:



Sửa nhiệm vụ: Người nhận (assignee) không có quyền sửa đổi nội dung nhiệm vụ.



Hoàn thành: Khi làm xong, người nhận chỉ có thể thực hiện hành động "Gửi duyệt".



Chấm điểm: Chỉ người đã giao việc (assigner) mới có quyền duyệt hoàn thành và chấm điểm.



3.2. Quy tắc Giao việc (Assignment Rules):



Quy tắc tối cao: Không ai được phép giao việc cho vai trò Lãnh đạo Cơ quan (Super Admin).



Tự giao việc: Mọi vai trò đều có quyền tự tạo và giao việc cho chính mình.



Lãnh đạo Cơ quan → giao việc trực tiếp cho tất cả các vai trò khác.



Lãnh đạo Văn phòng → giao việc cho Lãnh đạo Phòng và Chuyên viên Văn phòng.



Lãnh đạo Phòng → giao việc cho Chuyên viên Phòng (trong phòng ban của mình).



Chuyên viên Phòng → chỉ được giao việc cho chính mình.



(Quy tắc đặc biệt) Chuyên viên Văn phòng → giao việc cho Lãnh đạo Phòng (yêu cầu phê duyệt).



3.3. Quy tắc về Tầm nhìn Dữ liệu (Data Visibility Rules):



Lãnh đạo Cơ quan (Global View): Thấy tất cả tài khoản và nhiệm vụ.



Lãnh đạo Văn phòng (Office-scoped View): Thấy tài khoản của Lãnh đạo Phòng và Chuyên viên Văn phòng; thấy các nhiệm vụ liên quan.



Lãnh đạo Phòng (Department-scoped View): Chỉ thấy tài khoản và nhiệm vụ trong phòng ban của mình.



Chuyên viên (Personal View): Chỉ thấy nhiệm vụ của bản thân.



3.4. Quy tắc Phê duyệt Đặc biệt (Special Approval Rule):



Đối với các nhiệm vụ do Chuyên viên Văn phòng giao cho Lãnh đạo Phòng (trạng thái PENDING\_ASSIGNMENT\_APPROVAL), quyền phê duyệt thuộc về Lãnh đạo Cơ quan HOẶC Lãnh đạo Văn phòng. Chỉ cần một trong hai người duyệt là hợp lệ.



3.5. Quy tắc Đánh giá \& Hoàn thành (Rating \& Completion Rules):



Thẩm quyền đánh giá: Chỉ Lãnh đạo Cơ quan, Lãnh đạo Văn phòng, Lãnh đạo Phòng mới có quyền thực hiện hành động "Đánh giá hoàn thành".



Điều kiện đánh giá: Hành động này chỉ khả dụng khi nhiệm vụ đang ở trạng thái PENDING\_COMPLETION\_APPROVAL (Chờ duyệt hoàn thành).



Giá trị mặc định: Trên giao diện, mức đánh giá sao mặc định là 5 sao. Người đánh giá có thể thay đổi nếu muốn.



4\. Các Luồng xử lý chính (Workflows)

4.1. Luồng Giao việc Đặc biệt: Chuyên viên Văn phòng → Lãnh đạo Phòng



Khởi tạo: Chuyên viên Văn phòng tạo nhiệm vụ, gán cho Lãnh đạo Phòng. Trạng thái nhiệm vụ tự động chuyển thành PENDING\_ASSIGNMENT\_APPROVAL.



Yêu cầu duyệt: Hệ thống gửi thông báo yêu cầu duyệt đến cả Lãnh đạo Cơ quan và Lãnh đạo Văn phòng.



Phê duyệt: Một trong hai người (Lãnh đạo Cơ quan hoặc Lãnh đạo Văn phòng) xem xét và duyệt nhiệm vụ.



Kích hoạt: Ngay khi một trong hai người duyệt, trạng thái nhiệm vụ lập tức chuyển thành ASSIGNED và xuất hiện trong danh sách việc của Lãnh đạo Phòng. Nhật ký hệ thống ghi rõ ai đã duyệt.



4.2. Luồng Nghiệm thu và Hoàn thành Nhiệm vụ

(Không thay đổi)



4.3. Luồng Xin Gia Hạn Nhiệm Vụ



Yêu cầu: Người nhận nhiệm vụ (assignee) nhấn nút "Xin gia hạn" trên giao diện chi tiết nhiệm vụ.



Nhập thông tin: Giao diện hiển thị một cửa sổ cho phép người nhận nhập lý do và chọn ngày hết hạn mới.



Gửi yêu cầu: Hệ thống gửi thông báo (qua chuông và Zalo) đến người đã giao việc (assigner).



Phê duyệt: Người giao việc nhận được yêu cầu và có hai lựa chọn: "Duyệt" hoặc "Từ chối".



Cập nhật:



Nếu "Duyệt", ngày hết hạn của nhiệm vụ được cập nhật.



Nếu "Từ chối", ngày hết hạn giữ nguyên.



Thông báo kết quả: Hệ thống gửi thông báo kết quả duyệt/từ chối cho người đã xin gia hạn. Mọi hành động đều được ghi vào nhật ký nhiệm vụ.



5\. Yêu cầu về Giao diện (UI) và Trải nghiệm người dùng (UX)

5.1. Trang Tạo Mới (Hồ sơ công việc, Kế hoạch, Nhiệm vụ)



Thời gian tạo: Trường "Ngày tạo" phải được mặc định lấy ngày và giờ hiện tại của hệ thống, không cho phép chỉnh sửa.



5.2. Trạng thái Nhiệm vụ (Task Status)



Trạng thái mặc định: Khi một nhiệm vụ được tạo và giao trực tiếp (không qua phê duyệt), trạng thái ban đầu hiển thị cho người dùng là "Đang thực hiện".



Trạng thái chờ duyệt: Trạng thái "Chờ duyệt giao" chỉ hiển thị cho các nhiệm vụ được tạo theo luồng xử lý đặc biệt (4.1).



5.3. Chức năng Đánh giá (Rating Function)



Mặc định: Khi cửa sổ/phần đánh giá hiển thị, số sao phải được mặc định là 5 sao.



5.4. Chức năng Xin Gia Hạn (Extension Request)



Vị trí nút: Nút "Xin gia hạn" phải luôn có sẵn và dễ thấy cho người nhận nhiệm vụ (assignee) trong suốt quá trình nhiệm vụ đang ở trạng thái "Đang thực hiện".



6\. Yêu cầu về Hệ thống Thông báo (Notification System)

Kênh thông báo: Mọi thông báo trong hệ thống phải được gửi đồng thời qua 2 kênh:



Chuông thông báo (In-app Notification): Hiển thị icon chuông trên giao diện web/app.



Zalo: Tích hợp Zalo API để gửi tin nhắn thông báo.



Các sự kiện cần thông báo:



Khi được giao một nhiệm vụ mới.



Khi nhiệm vụ bạn giao được duyệt (trong luồng đặc biệt).



Khi nhiệm vụ bạn giao đã được người nhận gửi duyệt hoàn thành.



Khi yêu cầu xin gia hạn của bạn được duyệt/từ chối.



Khi có yêu cầu xin gia hạn cho nhiệm vụ bạn đã giao.



Khi nhiệm vụ bạn nhận được đánh giá/hoàn thành.



Các nhắc nhở về nhiệm vụ sắp hết hạn.



7\. Yêu cầu về Nhật ký (Audit Log Requirements)

Mọi hành động quan trọng (Tạo, Giao, Gửi duyệt, Phê duyệt, Hoàn thành, Đánh giá, Xin gia hạn, Duyệt gia hạn, Từ chối gia hạn) đều phải được ghi lại trong nhật ký của nhiệm vụ với thông tin: Ai, Làm gì, Khi nào, và Thay đổi chi tiết.



Tóm tắt cho AI / Lập trình viên

Mô hình: User, Role, Department, Task, Notification.



Ràng buộc cốt lõi: Vai trò Lãnh đạo Cơ quan là Super Admin và không thể là assignee.



Quyền đánh giá: Giới hạn cho 3 vai trò Lãnh đạo và chỉ khi nhiệm vụ ở trạng thái PENDING\_COMPLETION\_APPROVAL.



Luồng mới: Triển khai luồng "Xin gia hạn" hoàn chỉnh, bao gồm UI, logic phê duyệt và thông báo.



Tích hợp: Cần tích hợp Zalo API và xây dựng một trung tâm thông báo (Notification Center) trong ứng dụng.



UI/UX: Chú trọng vào các giá trị mặc định (thời gian, trạng thái, sao) để tăng tốc độ thao tác cho người dùng.



Bước tiếp theo:



Thiết kế giao diện (UI Mockups) cho màn hình tạo mới, chi tiết nhiệm vụ, cửa sổ xin gia hạn, và cửa sổ đánh giá.



Cập nhật Database Schema để hỗ trợ các trường mới (nếu cần).



Phát triển API cho chức năng xin gia hạn.



Xây dựng service gửi thông báo đa kênh (In-app, Zalo).



This is a test line to trigger a Git push.

